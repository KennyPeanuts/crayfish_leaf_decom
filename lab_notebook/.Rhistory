setwd("~/current_research/crayfish_leaf_decom/lab_notebook")
leaf.initial <- read.table("./data/initial_leaf_mass.csv", header = T, sep = ",")
leaf.T1 <- read.table("./data/T1_leaf_mass.csv", header = T, sep = ",")
leaf.T2 <- read.table("./data/T2_leaf_mass.csv", header = T, sep = ",")
leaf.T3 <- read.table("./data/T3_leaf_mass.csv", header = T, sep = ",")
treat <- read.table("./data/tank_map.csv", header = T, sep = ",")
#### Merge treatment information
leaf.T1 <- merge(leaf.T1, treat, by.x = "BagTank", by.y = "tank")
leaf.T2 <- merge(leaf.T2, treat, by.x = "BagTank", by.y = "tank")
leaf.T3 <- merge(leaf.T3, treat, by.x = "BagTank", by.y = "tank")
### Calculate variables
#### Initial AFDM
initialDM <- leaf.initial$CrucLeafDM - leaf.initial$CrucMass
initialAM <- leaf.initial$CrucAM - leaf.initial$CrucMas
AFDM <- initialDM - initialAM
leaf.initial <- data.frame(leaf.initial, AFDM)
mean.initial.AFDM <- mean(AFDM)
#### T1 AFDM
T1DM <- leaf.T1$CrucLeafDM - leaf.T1$CrucMass
T1AM <- leaf.T1$CrucAM - leaf.T1$CrucMass
AFDM <- T1DM - T1AM
leaf.T1 <- data.frame(leaf.T1, AFDM)
#### T2 AFDM
T2DM <- leaf.T2$CrucLeafDM - leaf.T2$CrucMass
T2AM <- leaf.T2$CrucAM - leaf.T2$CrucMass
AFDM <- T2DM - T2AM
leaf.T2 <- data.frame(leaf.T2, AFDM)
#### T3 AFDM
T3DM <- leaf.T3$CrucLeafDM - leaf.T3$CrucMass
T3AM <- leaf.T3$CrucAM - leaf.T3$CrucMass
AFDM <- T3DM - T3AM
leaf.T3 <- data.frame(leaf.T3, AFDM)
### Analyze Mass Lost with time
#### Remove tanks with C. longulus in them
# create a single data frame with the T1 - T3 AFDM
leaf.AFDM.raw <- rbind(leaf.T1, leaf.T2, leaf.T3)
leaf.AFDM <- leaf.AFDM.raw[leaf.AFDM.raw$BagTank != 3 & leaf.AFDM.raw$BagTank != 4,]
# convert to percent remaining in the tank
percAFDM.rem <- (leaf.AFDM$AFDM / mean.initial.AFDM) * 100
# calculate the time in the tank
#date <- c(as.Date(leaf.T1$Date), as.Date(leaf.T2$Date), as.Date(leaf.T3$Date))
#time.step <- c(rep("T1", 30), rep("T2", 30), rep("T3", 30))
# calculate the number of days elapsed
days.elapsed <- as.Date(leaf.AFDM$Date) - as.Date(unique(leaf.initial$Date))
days.elapsed <- as.numeric(days.elapsed)
# add calc variables to data frame
leaf.AFDM <- data.frame(leaf.AFDM, percAFDM.rem, days.elapsed)
### Calculate K for each tank
#### Create a function that calculates k for each tank
k.tank <- function() {
k <- numeric(0)
treat <- character(0)
tank_name = unique(leaf.AFDM$BagTank)
index = seq_along(tank_name)
for(i in index) {
treat[i] <- as.character(leaf.AFDM$treatment[index == i])[1]
k[i] <- coef(summary(lm(log(leaf.AFDM$percAFDM.rem + 1)[index == i] ~ leaf.AFDM$days.elapsed[index == i])))[2, 1] # this extracts the slope (col 2, row 1) from the matrix of coefficents produced by the lm
}
data.frame(tank_name, treat, k)
}
# run the function
k.list <- k.tank()
k.list
par(las = 1)
x <- factor(k.list$treat, levels=c("N", "I", "L", "E", "H"))
plot(k ~ x, data = k.list, ylim = c(-0.3, 0), col = "wheat", ylab = "k (1/day)", xlab = "Treatment")
dev.copy(jpeg, "./output/plots/k_by_treat.jpg")
cf.sp.alone <- factor(leaf.AFDM$treatment, levels = c("N", "I"))
cf.sp.alone <- factor(k.list$treat, levels = c("N", "I"))
plot(k ~ cf.sp.alone, data = k.list)
plot(k ~ cf.sp.alone, data = k.list)
plot(k ~ cf.sp.alone, data = k.list)
plot(k.list$k ~ cf.sp.alone)
k.list
plot(k ~ treat, data = k.list)
plot(1:10, 1:10)
par(las = 1)
plot(1:10, 1:10)
plot()
