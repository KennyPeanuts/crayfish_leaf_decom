setwd("~/current_research/crayfish_leaf_decom/lab_notebook")
leaf.initial <- read.table("./data/initial_leaf_mass.csv", header = T, sep = ",")
leaf.T1 <- read.table("./data/T1_leaf_mass.csv", header = T, sep = ",")
leaf.T2 <- read.table("./data/T2_leaf_mass.csv", header = T, sep = ",")
leaf.T3 <- read.table("./data/T3_leaf_mass.csv", header = T, sep = ",")
treat <- read.table("./data/tank_map.csv", header = T, sep = ",")
#### Merge treatment information
leaf.T1 <- merge(leaf.T1, treat, by.x = "BagTank", by.y = "tank")
leaf.T2 <- merge(leaf.T2, treat, by.x = "BagTank", by.y = "tank")
leaf.T3 <- merge(leaf.T3, treat, by.x = "BagTank", by.y = "tank")
### Calculate variables
#### Initial AFDM
initialDM <- leaf.initial$CrucLeafDM - leaf.initial$CrucMass
initialAM <- leaf.initial$CrucAM - leaf.initial$CrucMas
AFDM <- initialDM - initialAM
leaf.initial <- data.frame(leaf.initial, AFDM)
mean.initial.AFDM <- mean(AFDM)
#### T1 AFDM
T1DM <- leaf.T1$CrucLeafDM - leaf.T1$CrucMass
T1AM <- leaf.T1$CrucAM - leaf.T1$CrucMass
AFDM <- T1DM - T1AM
leaf.T1 <- data.frame(leaf.T1, AFDM)
#### T2 AFDM
T2DM <- leaf.T2$CrucLeafDM - leaf.T2$CrucMass
T2AM <- leaf.T2$CrucAM - leaf.T2$CrucMass
AFDM <- T2DM - T2AM
leaf.T2 <- data.frame(leaf.T2, AFDM)
#### T3 AFDM
T3DM <- leaf.T3$CrucLeafDM - leaf.T3$CrucMass
T3AM <- leaf.T3$CrucAM - leaf.T3$CrucMass
AFDM <- T3DM - T3AM
leaf.T3 <- data.frame(leaf.T3, AFDM)
### Analyze Mass Lost with time
# create a single data frame with the T1 - T3 AFDM
leaf.AFDM <- rbind(leaf.T1, leaf.T2, leaf.T3)
# convert to percent remaining in the tank
percAFDM.rem <- (leaf.AFDM$AFDM / mean.initial.AFDM) * 100
# calculate the time in the tank
date <- c(as.Date(leaf.T1$Date), as.Date(leaf.T2$Date), as.Date(leaf.T3$Date))
time.step <- c(rep("T1", 30), rep("T2", 30), rep("T3", 30))
# calculate the number of days elapsed
days.elapsed <- date - as.Date(leaf.initial$Date)[1]
# add calc variables to data frame
leaf.AFDM <- data.frame(leaf.AFDM, percAFDM.rem, days.elapsed)
library("lmerTest", lib.loc="~/Library/R/3.1/library")
##### Function designation
k.tank <- function() {
# create empty objects
k <- numeric(0)
tank <- numeric(0)
treat <- character(0)
block <- character(0)
for(i in leaf.AFDM$BagTank)
k <- c(coef(summary(lm(log(leaf.AFDM$percAFDM.rem + 1)[leaf.AFDM$BagTank == i] ~ leaf.AFDM$days.elapsed[leaf.AFDM$BagTank == i])))[2, 1], k) # this extracts the slope (col 2, row 1) from the matrix of coefficents produced by the lm
for(i in leaf.AFDM$BagTank)
tank <- c(i, tank)
for(i in leaf.AFDM$BagTank)
treat <- c(as.character(leaf.AFDM$treatment[leaf.AFDM$BagTank == i]), treat)
for(i in leaf.AFDM$BagTank)
block <- c(as.character(leaf.AFDM$block[leaf.AFDM$BagTank == i]), block)
k.list <- data.frame(unique(tank), unique(treat), unique(block), unique(k)) # the "unique" is needed because the tank numbers are repreated for each day in the dataset so the for-loop runs 3X. The unique eliminates the duplicate data
return(k.list)
}
k.list <- k.tank()
names(k.list) <- c("tank", "treat", "block", "k")
summary(k.list$k)
sd(k.list$k)
tapply(k.list$k, k.list$treat, summary)
tapply(k.list$k, k.list$treat, sd)
(k.mod <- lmer(percAFDM.rem ~ 1 + days.elapsed * treatment * block + (1|BagTank), data = leaf.AFDM)
)
(k.mod <- lmer(percAFDM.rem ~ 1 + days.elapsed * treatment + (1|BagTank), data = leaf.AFDM))
anova(k.mod)
(k.mod <- lmer(percAFDM.rem ~ 1 + treatment * block + (1|BagTank), data = leaf.AFDM))
(k.mod <- lmer(percAFDM.rem ~ 1 + treatment + block + (1|BagTank), data = leaf.AFDM))
anova(k.mod)
(k.mod <- lmer(percAFDM.rem ~ 1 days.elapsed + treatment + block + (1|BagTank), data = leaf.AFDM))
(k.mod <- lmer(percAFDM.rem ~ 1 + days.elapsed * treatment * block + (1|BagTank), data = leaf.AFDM))
(k.mod <- lmer(percAFDM.rem ~ 1 + days.elapsed * treatment + block + (1|BagTank), data = leaf.AFDM))
anova(k.mod)
(k.mod <- lmer(percAFDM.rem ~ 1 + days.elapsed * treatment + block + (1|BagTank), data = leaf.AFDM))
anova(k.mod)
coef(summary(lm(log(leaf.AFDM$percAFDM.rem + 1)[leaf.AFDM$BagTank == i] ~ leaf.AFDM$days.elapsed[leaf.AFDM$BagTank == i])))[2, 1
]
summary(lm(log(leaf.AFDM$percAFDM.rem + 1) ~ leaf.AFDM$days.elapsed))
coef(summary(lm(log(leaf.AFDM$percAFDM.rem + 1) ~ leaf.AFDM$days.elapsed)))
leaf.AFDM$percentAFDM.rem
leaf.AFDM$percAFDM.rem
leaf.initial
summary(leaf.initial)
sd(leaf.initial)
sd(leaf.initial$AFDM)
sd(leaf.AFDM$AFDM, leaf.AFDM$days.elapsed, summary)
tapply(leaf.AFDM$AFDM, leaf.AFDM$days.elapsed, sd)
tapply(leaf.AFDM$percAFDM.rem, leaf.AFDM$days.elapsed, sd)
leaf.AFDM$days.elapsed
leaf.AFDM$treatment
t.test(k.list$k[k.list$treat == "N"], k.list$k[k.list$treat == "I"])
setwd("~/current_research/crayfish_leaf_decom/lab_notebook")
ysi <- read.table("./data/tank_YSI.csv", header = T, sep = ",")
chl <- read.table("./data/tank_chl.csv", header = T, sep = ",")
treat <- read.table("./data/tank_map.csv", header = T, sep = ",")
### Merge tank map with chem data
chl <- merge(chl, treat, by = "tank")
chl.trunk <- chl
chl.trunk$Chl[chl.trunk$Chl < 0 ] <- NA
ordered.treat <- factor(chl.trunk$treatment, levels = c("N", "I", "L", "E", "H"))
(chl.mod <- lmer(Chl ~ 1 + Date * treatment * block + (1|tank), data = chl.trunk))
(chl.mod <- lmer(Chl ~ 1 + Date * treatment + block + (1|tank), data = chl.trunk))
anova(chl.mod)
(chl.mod <- lmer(Chl ~ 1 + Date * treatment + (1|tank), data = chl.trunk))
anova(chl.mod)
(chl.mod <- lmer(Chl ~ 1 + Date * treatment + block + (1|tank), data = chl.trunk))
anova(chl.mod)
unique(chl.trunk$Date)
days.elapsed <- as.Date(chl.trunk$Date) - as.Date("2016-06-03")
days.elapsed
chl.trunk$Date
(chl.mod <- lmer(Chl ~ 1 + days.elapsed * treatment + block + (1|tank), data = chl.trunk))
anova(chl.mod)
days.elapsed <- as.Date(chl.trunk$Date) - as.Date("2016-06-03")
days.elapsed
str(days.elapsed)
days.elapsed <- as.numeric(as.Date(chl.trunk$Date) - as.Date("2016-06-03"))
(chl.mod <- lmer(Chl ~ 1 + days.elapsed * treatment + block + (1|tank), data = chl.trunk))
anova(chl.mod)
